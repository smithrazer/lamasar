<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lum‚ÄôAsar Web GUI v2.3</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; color: #333; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; }
    h1 { text-align: center; color: #4a90e2; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; }
    .controls > div { flex: 1 1 200px; }
    .syllables, .markers { background: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    label { display: block; margin-bottom: 5px; cursor: pointer; }
    button { background: #4caf50; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px; }
    button:hover { background: #43a047; }
    #output { background: #fff; padding: 10px; border-radius: 8px; min-height: 100px; margin-top: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); white-space: pre-wrap; }
    input[type=file] { margin-bottom: 10px; }
    img { max-width: 300px; display: block; margin-bottom: 10px; }
    canvas { background: #fff; border: 1px solid #ccc; margin-top: 10px; width: 100%; height: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Lum‚ÄôAsar Web GUI v2.3</h1>

    <input type="file" id="imgInput" accept="image/*">
    <img id="preview" src="" alt="Preview">

    <div class="controls">
      <div class="syllables">
        <h3>–°–ª–æ–≥–∏ (–¥–æ 4)</h3>
        <div id="syllables"></div>
      </div>
      <div class="markers">
        <h3>–ì—Ä–∞–º–º. –º–∞—Ä–∫–µ—Ä</h3>
        <div id="markers"></div>
      </div>
    </div>

    <div style="margin-top:10px;">
      <label>–°–¥–≤–∏–≥ —á–∞—Å—Ç–æ—Ç—ã: <span id="shiftVal">0</span> –ì—Ü</label>
      <input type="range" id="shift" min="-20" max="20" value="0">
    </div>

    <button id="generate">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∞–Ω—Ç—Ä—É</button>

    <div id="output"></div>
    <!-- Canvas placeholder (drawing disabled) -->
    <canvas id="canvas"></canvas>
  </div>

  <script>
    const LUM_ASAR = {
      Lu:{freq:432, color:'#FFD700', symbol:'üåÄ'}, Sa:{freq:528, color:'#FF69B4', symbol:'‚îÄ'},
      Ra:{freq:639, color:'#FF4500', symbol:'üî∫'}, Va:{freq:741, color:'#32CD32', symbol:'‚ö™Ô∏è'},
      Mi:{freq:852, color:'#1E90FF', symbol:'üîµ'}, Ke:{freq:963, color:'#000000', symbol:'‚ö´Ô∏è'},
      Nu:{freq:684, color:'#8B4513', symbol:'üü´'}, Mu:{freq:720, color:'#008080', symbol:'üü¢'},
      Fi:{freq:396, color:'#FF4500', symbol:'üî•'}, Wa:{freq:417, color:'#1E90FF', symbol:'üåä'},
      Ai:{freq:471, color:'#A9A9A9', symbol:'üí®'}, Ea:{freq:333, color:'#8B4513', symbol:'üåç'},
      Is:{freq:396, color:'#8B4513', symbol:'üì•'}, Za:{freq:417, color:'#FF69B4', symbol:'üåÄ'},
      Zi:{freq:528, color:'#FF4500', symbol:'üåä'}, Pe:{freq:639, color:'#FFD700', symbol:'‚ö™Ô∏è'},
      La:{freq:741, color:'#32CD32', symbol:'üî∫'}, Le:{freq:852, color:'#1E90FF', symbol:'üîµ'},
      Us:{freq:963, color:'#00008B', symbol:'‚îÄ'}, Ch:{freq:1080, color:'#4B0082', symbol:'‚ö™Ô∏èüî∫'},
      Ro:{freq:1152, color:'#800080', symbol:'üü´'}
    };
    const GR_MARKERS = { ka:{desc:'–∏—Å—Ü–µ–ª—è—é—â–∞—è', symbol:'üîÜ'}, ta:{desc:'–∞–∫—Ç–∏–≤–∏—Ä—É—é—â–∞—è', symbol:'‚ö°'}, na:{desc:'–º–µ–¥–∏—Ç–∞—Ç–∏–≤–Ω–∞—è', symbol:'üßò'} };

    let selected=[], marker='';
    const sylDiv=document.getElementById('syllables'), markDiv=document.getElementById('markers');
    const shift=document.getElementById('shift'), shiftVal=document.getElementById('shiftVal');
    const out=document.getElementById('output');

    Object.keys(LUM_ASAR).forEach(s=>{
      const cb=document.createElement('input'), lbl=document.createElement('label');
      cb.type='checkbox'; cb.value=s;
      cb.onchange=()=>{ if(cb.checked){ if(selected.length<4) selected.push(s); else cb.checked=false; } else selected=selected.filter(x=>x!==s); showCurrent(); };
      lbl.textContent=s; lbl.prepend(cb); sylDiv.append(lbl);
    });
    Object.keys(GR_MARKERS).forEach(m=>{
      const rb=document.createElement('input'), lbl=document.createElement('label');
      rb.type='radio'; rb.name='marker'; rb.value=m;
      rb.onchange=()=>{ marker=m; showCurrent(); };
      lbl.textContent=m; lbl.prepend(rb); markDiv.append(lbl);
    });

    shift.oninput=()=>{ shiftVal.textContent=shift.value; };

    function showCurrent(){ out.textContent=`–°–ª–æ–≥–∏: ${selected.join(', ')}  –ú–∞—Ä–∫–µ—Ä: ${marker}`; }

    function generate(){
      if(!selected.length){ out.textContent='–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–æ–≥–∏!'; return; }
      const freqs=selected.map(s=>LUM_ASAR[s].freq+parseInt(shift.value));
      const avg=freqs.reduce((a,b)=>a+b)/freqs.length;
      const form=selected.join('-')+(marker?'-'+marker:'');
      const syms=selected.map(s=>LUM_ASAR[s].symbol).join('')+(marker?GR_MARKERS[marker].symbol:'');
      const desc=selected.map(s=>LUM_ASAR[s].symbol).join(', ')+(marker?`, ${GR_MARKERS[marker].desc}`:'');
      out.textContent = `–§–æ—Ä–º—É–ª–∞: ${form}\n–ß–∞—Å—Ç–æ—Ç—ã: [${freqs.join(', ')}]\n–°—Ä–µ–¥–Ω—è—è: ${avg.toFixed(1)} –ì—Ü\n–û–ø–∏—Å–∞–Ω–∏–µ: ${desc}\n–°–∏–º–≤–æ–ª—ã: ${syms}`;
      playTone(avg);
    }
    document.getElementById('generate').onclick=generate;

    document.getElementById('imgInput').onchange=e=>{ const f=e.target.files[0]; if(f){ document.getElementById('preview').src=URL.createObjectURL(f); } };

    function playTone(freq){ if(!window.AudioContext) return; const ac=new AudioContext(), osc=ac.createOscillator(), gain=ac.createGain();
      osc.frequency.value=freq; osc.connect(gain); gain.connect(ac.destination);
      osc.start(); gain.gain.exponentialRampToValueAtTime(0.0001, ac.currentTime+0.8);
      setTimeout(()=>{ osc.stop(); ac.close(); },800);
    }
  </script>
</body>
</html>
